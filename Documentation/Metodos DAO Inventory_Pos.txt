//Metodos Dao Venta

public Double getSumVentaTotal(String date) {
        EntityManager em = getEntityManager();
        try {
            return (Double) em.createNativeQuery("SELECT SUM(ve_preciototal) FROM venta WHERE date(ve_fechaventa)='"+date+"'").getResultList().get(0);
        } finally {
            em.close();
        }
    }
	
//Metodos Dao Departamento//
public Departamento findDepartamentoByDescripcion(String descripcion) {
        EntityManager em = getEntityManager();
        try {
            return (Departamento) em.createNamedQuery("Departamento.findByDpDescripcion", Departamento.class).setParameter("dpDescripcion", descripcion).getResultList().get(0);
        }catch(Exception e){
             return null;
        }finally {
            em.close();           
        }
    }


//Metodos Dao Inventario//
public Inventario getInventarioLast() {
        EntityManager em = getEntityManager();
        try {
            return (Inventario) em.createNativeQuery("Select * from inventario order by in_codigo desc limit 1", Inventario.class).getResultList().get(0);
        }catch(Exception e){
            return null;
        } finally {
            em.close();
        }
    }

//Metodos Dao Ventas//
public Venta getNumFacLast() {
        EntityManager em = getEntityManager();
        try {
            return (Venta) em.createNativeQuery("Select * from venta order by ve_factventa desc limit 1", Venta.class).getResultList().get(0);
        }catch(Exception e){
            return null;
        } finally {
            em.close();
        }
    }
//Metodos Dao Dventa
public List<Dventa> getBestProducts() {
        EntityManager em = getEntityManager();
        try {
             List<Dventa> l = em.createNativeQuery("SELECT dve_id,dve_idinventario FROM dventa GROUP by dve_idinventario order by sum(dve_cantidad) desc limit 10",Dventa.class).getResultList();      
            return l;
        }catch(Exception e){            
            return null;
        } finally {
            em.close();
        }
    } 
	
	